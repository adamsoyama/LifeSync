import"./modulepreload-polyfill-B5Qt9EMX.js";import{f as g,C as B,T as b,i as T,a as S,b as D}from"./services-w6WyPBlA.js";const $="https://api.apilayer.com/fixer/latest",k="https://api.twelvedata.com/time_series";async function w(t){var a;const e=`${$}?base=USD&symbols=${t}`,o=await g(e,{headers:{apikey:B}});return(a=o==null?void 0:o.rates)!=null&&a[t]?o.rates[t]:(console.warn("Fallback to 1.0 rate"),1)}async function L(t){var o;const e=`${k}?symbol=${t}&interval=1day&outputsize=1&apikey=${b}`,n=await g(e);if(console.log("ðŸ“ˆ Twelve Data response:",n),((o=n==null?void 0:n.values)==null?void 0:o.length)>0){const a=n.values[0];return{symbol:t,price:a.close,date:a.datetime}}return{symbol:t,price:"Unavailable",date:"",fallback:!0}}const h=document.getElementById("total-income"),x=document.getElementById("total-expenses"),d=document.getElementById("current-balance"),A=document.getElementById("usd-amount"),C=document.getElementById("currency-select"),F=document.getElementById("convert-currency"),i=document.getElementById("exchange-rate"),_=document.getElementById("converted-amount"),O=document.getElementById("stock-symbol"),R=document.getElementById("fetch-stock"),s=document.getElementById("stock-price");document.getElementById("market-cap");const U=document.getElementById("stock-history"),N=document.getElementById("transaction-list"),y=document.getElementById("health-score"),M=document.getElementById("return-dashboard"),l=document.getElementById("monthly-budget"),P=document.getElementById("save-budget"),u=document.createElement("button"),m=document.createElement("button");u.textContent="Add Income";m.textContent="Add Expense";document.querySelector(".summary-box").appendChild(u);document.querySelector(".summary-box").appendChild(m);let r=JSON.parse(localStorage.getItem("transactions"))||[],c=JSON.parse(localStorage.getItem("monthlyBudget"))||{amount:0,month:new Date().getMonth()};function p(){const t={income:h.innerText,expenses:x.innerText,balance:d.innerText,exchangeRate:i.innerText,stockPrice:s.innerText,timestamp:new Date().toISOString()};localStorage.setItem("financeSummary",JSON.stringify(t))}function E(){const t=r.filter(o=>o.type==="income").reduce((o,a)=>o+a.amount,0),e=r.filter(o=>o.type==="expense").reduce((o,a)=>o+a.amount,0),n=t-e;h.innerText=`â‚¦${t}`,x.innerText=`â‚¦${e}`,d.innerText=`â‚¦${n}`,f(n),p()}function f(t){const{amount:e}=c;if(!e||e<=0){y.innerText="Set a budget to evaluate.";return}const n=t/e*100;let o="";n>=100?o="Excellent! You're managing well.":n>=80?o="Good. Monitor expenses.":n>=50?o="Caution. Approaching limit.":o="Overspent! Reconsider budget.",y.innerText=`${o} (${n.toFixed(1)}% of budget)`}function v(){const t=r.slice(-5).reverse();N.innerHTML=t.map(e=>`<div class="transaction-item">${e.type.toUpperCase()}: â‚¦${e.amount} - ${e.note||"No note"}</div>`).join("")||"No records found."}function I(t){const e=parseFloat(prompt(`Enter ${t} amount:`));if(!e||e<=0)return;const n=prompt("Add a note (optional):");r.push({type:t,amount:e,note:n,date:new Date().toISOString()}),localStorage.setItem("transactions",JSON.stringify(r)),v(),E()}async function Y(){try{i.innerText="Fetching rates...";const t=C.value,e=parseFloat(A.value)||0,n=await w(t);i.innerText=`1 USD = ${n.toFixed(2)} ${t}`,_.innerText=`${(e*n).toFixed(2)} ${t}`,p()}catch{i.innerText="Conversion failed!"}}async function H(){try{s.innerText="Fetching...";const t=O.value.toUpperCase();if(!t)return;const e=await L(t);!e.price||e.price==="Unavailable"?s.innerText="Unavailable":(s.innerText=`${t}: $${e.price}`,U.innerHTML=`<li>${new Date(e.date).toLocaleDateString()}: $${e.price}</li>`),p()}catch{s.innerText="Fetch failed!"}}function J(){const e=new Date().getMonth();if(c.month===e){alert("You can only update the budget next month."),l.value=c.amount;return}const n=parseFloat(l.value);n>0&&(c={amount:n,month:e},localStorage.setItem("monthlyBudget",JSON.stringify(c)),alert("Budget saved!"),f(parseFloat(d.innerText.replace("â‚¦",""))||0))}F.addEventListener("click",Y);R.addEventListener("click",H);P.addEventListener("click",J);u.addEventListener("click",()=>I("income"));m.addEventListener("click",()=>I("expense"));M.addEventListener("click",()=>{window.location.href="/lifesync/src/pages/dashboard.html"});document.addEventListener("DOMContentLoaded",()=>{T(),S(),D(),v(),E(),l.value=c.amount});
